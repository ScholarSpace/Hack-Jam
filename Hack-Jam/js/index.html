<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>example 2</title>
</head>
<body>
    <h1>ScholarSpace dtb</h1>
    DB <input type = 'text' value = 'studentDetails' id = 'txtDB'>
    Version <input type = 'text' value = '1' id = 'txtVersion'>
    <button id = 'btnCreateDB'>Create DB</button>
    <button id = 'AddDetails'>Add Details</button>

    <script>

        let db = null;

        const btnCreateDB = document.getElementById("btnCreateDB");
        btnCreateDB.addEventListener("click", createDB);


    function addDetails() {
        //object:
        const details = {
            id: "MD001",
            title: "Musa",
            surname: "Dube",
            email: "2f1vh7hv7@ovssie.net"
        }
        const btnAddDetails = document.getElementById("btnAddDetails")
        btnAddDetails.addEventListener("click", addDetails);
        const info = db.transaction("information","readwrite");
        const infoAdd = info.objectStore("information"); 
        infoAdd.add(details); // add object to database 
    }
    //create a database:
    function createDB() {
        const dbName = document.getElementById("txtDB").value;
        const dbVersion = document.getElementById("txtVersion").value;

        const request = indexedDB.open(dbName, dbVersion);
        //upgrade needed is the creating stage so dataabase and stores
        request.onupgradeneeded = e => {
            const db = e.target.result;

            //object store or table:
            const bioInfo = db.createObjectStore("information",{keyPath: "id"});
            /*studentDetails = {
                title: "name", //key 
                text: "Musa"
            }*/
            alert(`upgrade is called database name ${db.name} version ${db.version}`);
        }
        //on success:
        request.onsuccess = e => {
            const db = e.target.result;
            alert( `success is called database name ${db.name} version ${db.version}`);

        }
        //on fail:
        request.onerror= e => {
            alert(`error ! ${e.target.error}`);// equivilent to using + to concatenate the line of code
        }
    }

    
    </script>
</body>
</html>